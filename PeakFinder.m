data = [
0.000225
0.000106
0.000087
0.000316
0.000152
0.000165
0.000297
0.000014
0.000119
0.000257
-0.000005
0.000133
0.000251
0.000021
0.000218
0.000152
0.000146
0.000297
0.000113
0.000027
0.000343
0.000087
0.000047
0.000323
-0.000038
0.000152
0.000284
-0.000124
0.000244
0.00031
-0.000084
0.000251
0.00027
-0.000104
0.000225
0.000225
-0.000051
0.000395
0.000514
0.000356
0.000671
0.000757
0.000336
0.000605
0.000573
0.00052
0.000632
0.000625
0.000343
0.000369
0.000238
0.000198
0.000179
0.000179
0.0001
0.000264
0.000185
0.000133
0.000277
0.000257
0.000211
0.000389
0.000382
0.000356
0.000599
0.000408
0.000284
0.000625
0.000303
0.000146
0.000461
0.000205
0.00008
0.000376
0.000146
0.000146
0.000422
0.000185
0.000264
0.000238
0.000093
0.000277
0.000349
0.0001
0.00031
0.000192
0.000152
0.000395
0.000231
0.000133
0.000468
0.000152
0.000185
0.000481
0.0001
0.000185
0.000422
-0.000032
0.000165
0.000395
-0.000104
0.000251
0.00031
-0.000032
0.00031
0.00027
-0.000032
0.000284
0.000231
0.000146
0.000619
0.000651
0.000395
0.000711
0.000638
0.000356
0.000619
0.00056
0.000487
0.000553
0.000369
0.000192
0.000297
0.000225
0.000034
0.00027
0.000093
0.000027
0.000192
0.000139
0.00006
0.00033
0.000126
0.000172
0.000415
0.000376
0.000251
0.000468
0.000415
0.000172
0.000369
0.000211
0.000067
0.000257
0.000034
0.000185
0.00029
0.000146
0.000251
0.00029
0.000067
0.000054
0.000198
-0.000019
0.000205
0.000133
-0.000025
0.000139
0.000034
0.000014
0.000192
0.000014
0.000041
0.000349
-0.000038
0.000119
0.000422
-0.000045
0.000133
0.000205
-0.000058
0.000146
0.000369
-0.000058
0.000225
0.000297
-0.000071
0.000284
0.000205
-0.000064
0.000218
0.000218
0.000408
0.000632
0.000546
0.000487
0.000487
0.000599
0.000376
0.000566
0.000415
0.000316
0.000389
0.000362
0.000133
0.000231
0.000034
0.000073
0.000205
0.000126
0.000073
0.000172
0.000238
0.000126
0.000336
0.00027
0.000198
0.000461
0.00029
0.000264
0.000468
0.000277
0.000179
0.000356
0.000146
0.000133
0.000244
0.000211
0.000349
0.00031
0.000231
0.000277
0.000198
-0.000012
0.000251
0.000139
0.000146
0.000284
0.000119
0.000133
0.000349
0.000034
0.000119
0.000408
0.000027
0.0001
0.000395
-0.000051
0.000244
0.000376
-0.000051
0.000146
0.000356
-0.000038
0.000218
0.000303
0.000008
0.000323
0.000264
0.000014
0.000119
0.000238
0.000054
0.000008
0.000454
0.000605
0.001006
0.00073
0.000546
0.00054
0.000605
0.000468
0.000586
0.000487
0.000362
0.000356
0.000231
0.000211
0.000133
0.000165
0.000093
0.000119
0.000198
0.000054
0.000165
0.000277
0.000218
0.000303
0.000349
0.000323
0.000474
0.00033
0.000356
0.000152
0.000179
0.000277
0.000251
0.000087
0.000205
0.000165
0.000106
0.000316
0.000185
0.000106
0.000376
0.000146
0.000093
0.000369
-0.000032
0.000146
0.000395
0.000001
0.000205
0.000428
0.000021
0.000205
0.000389
0.000073
0.000211
0.00033
-0.000045
0.000218
0.000257
-0.000025
0.000198
0.000238
0.000008
0.000238
0.000179
0.00006
0.000238
0.000113
-0.000012
0.000198
0.0001
0.000001
0.000369
0.000448
0.000316
0.000947
0.0005
0.000468
0.000474
0.000448
0.0005
0.0005
0.000415
-0.000005
0.000284
0.000185
0.000126
0.000225
0.000172
0.000027
0.000218
0.000165
0.000113
0.000356
0.000244
0.000376
0.000481
0.00033
0.000408
0.000474
0.000211
0.000349
0.000303
0.000073
0.000106
0.000185
-0.000045
0.000448
0.000185
0.000047
0.000651
0.000126
0.000041
0.000231
0.000021
0.000093
0.000638
-0.000078
0.000152
0.000408
-0.000038
0.000152
0.00052
-0.000051
0.000238
0.000297
-0.000104
0.000251
0.000297
-0.000058
0.00027
0.000238
-0.000019
0.000238
0.000192
0.000034
0.000192
0.000165
0.000047
0.000244
0.000205
0.00006
0.000376
0.000001
0.000349
0.000573
0.000592
0.000697
0.000829
0.000566
0.000546
0.000592
0.000776
0.00052
0.000487
0.000527
0.000185
0.000382
-0.000012
0.0001
0.000277
0.000087
0.000126
0.000349
-0.000124
0.000185
0.000448
0.000257
0.000376
0.00052
0.000198
0.000474
0.000494
-0.000071
0.000441
0.00029
-0.000209
0.000395
0.000172
0.000027
0.000422
0.000139
0.000185
0.000428
0.000073
0.000152
0.000389
-0.000012
0.000001
0.000415
-0.000038
0.000277
0.000349
0.000027
0.000119
0.000376
-0.000038
0.000303
0.00029
0.000034
0.000297
0.000211
0.000041
0.000014
0.000159
0.000054
0.000829
0.000139
0.000073
0.000816
0.000133
0.000093
0.000277
0.000152
0.0001
0.000461
0.000468
0.000527
0.000566
0.000671
0.000461
0.000789
0.000527
0.000691
0.000553
0.000474
0.000297
0.000461
0.00031
0.00008
0.000573
0.000211
0.000041
0.000481
0.000126
0.0001
0.00029
0.000126
0.000218
0.000651
0.000257
0.000362
0.000533
0.000211
0.000468
0.000041
0.000192
0.000362
-0.000025
0.000054
0.000251
0.000198
0.0001
0.000395
0.0005
0.000119
0.000389
-0.000124
0.000146
0.000323
0.000198
0.000205
0.000369
-0.00013
0.000179
0.00029
0.000146
0.000257
0.000284
0.000087
0.000303
0.000231
0.000021
0.000284
0.000159
0.000054
0.000218
0.000146
-0.000143
0.000198
0.000146
0.000014
0.000179
0.000113
-0.000038
0.000179
0.000179
-0.000038
0.000474
0.000487
0.000724
0.000711
0.000415
0.000579
0.00073
0.000402
0.000494
0.000461
0.000264
0.00008
0.000362
0.000073
0.000041
0.000257
0.000021
0.000067
0.000238
0.000073
0.000133
0.000297
0.000152
0.000343
0.000389
0.00027
0.000448
0.000395
0.00027
0.000435
0.000198
0.000152
0.000349
0.000054
0.0001
0.000369
0.000054
0.000244
0.000461
0.000047
0.000251
0.000389
-0.000025
0.000284
0.000362
0.000008
0.000336
0.000382
0.000047
0.000382
0.000316
0.000054
0.000389
0.000323
0.000172
0.000336
0.000257
0.000106
0.000297
0.000211
0.000152
0.000257
0.000185
0.000139
0.000251
0.000179
0.000067
0.000198
0.000159
0.000087
0.000198
0.000185
0.000494
0.000468
0.000632
0.00073
0.00054
0.000507
0.000415
0.000645
0.000527
0.000474
0.000454
0.000369
0.000231
0.000277
0.000231
0.000119
0.000251
0.000047
0.000231
0.000179
0.00006
0.000336
0.00029
0.000198
0.000494
0.000376
0.000303
0.000579
0.000356
0.00029
0.000494
0.000165
0.000225
0.000422
-0.000025
0.000152
0.000415
0.000041
0.000316
0.000428
0.000034
0.000264
0.000297
-0.000091
0.000238
0.000297
-0.000005
0.00029
0.000211
-0.000012
0.000231
0.000139
-0.000012
0.000257
0.000205
0.000041
0.000198
0.000146
-0.000005
0.000106
0.00008
-0.000012
0.000172
0.000093
0.000014
0.0001
0.000106
-0.000019
0.000159
0.000126
0.000067
0.000185
0.000514
0.00054
0.000849
0.000494
0.000514
0.000527
0.000474
0.000441
0.000711
0.000382
0.000343
0.000428
0.000172
0.000146
0.000343
0.000008
0.000211
0.000211
-0.000005
0.000192
0.000165
-0.000019
0.000303
0.00027
0.000205
0.000461
0.00027
0.000257
0.00054
0.000198
0.000251
0.000461
0.000041
0.000146
0.000316
-0.000124
0.000165
0.000356
-0.000058
0.000264
0.00031
-0.000084
0.000231
0.000257
-0.000045
0.000225
0.000172
-0.000032
0.000231
0.000139
0.000041
0.000244
0.000152
0.00008
0.000238
0.000139
0.000087
0.000146
0.000106
0.00008
0.000152
0.000113
0.000067
0.000185
0.000119
0.000093
0.000225
0.000152
0.000047
0.000238
0.000172
0.000093
0.000632
0.000704
0.000579
0.000803
0.000474
0.000533
0.000717
0.000704
0.000553
0.000651
0.000323
0.000336
0.000389
0.000073
0.00027
0.000244
0.000146
0.000323
0.000211
0.000139
0.000395
0.000225
0.000257
0.000586
0.00027
0.00033
0.000592
0.000225
0.000349
0.000579
0.000087
0.000284
0.000376
-0.000051
0.000225
0.00031
-0.000038
0.00033
0.000343
-0.000019
0.000336
0.000264
-0.000005
0.000284
0.000179
0.000034
0.000284
0.000133
0.000041
0.000257
0.000113
0.000093
0.000251
0.000179
0.000106
0.000244
0.000185
0.000073
0.000211
0.0001
0.000047
0.000238
0.000179
0.00006
0.00027
0.000159
0.000041
0.000159
0.000119
0.000021
0.00029
0.000211
0.000198
0.000678
0.000665
0.00054
0.000612
0.000277
0.000481
0.00056
0.000402
0.000441
0.000408
0.000133
0.00027
0.000106
-0.000071
0.000172
0.000047
-0.000019
0.000264
-0.000038
0.000027
0.000343
0.000119
0.000198
0.000546
0.000165
0.000297
0.000533
0.000159
0.000303
0.000428
-0.000051
0.000225
0.00029
-0.000084
0.000146
0.00027
-0.000012
0.000297
0.00027
-0.000032
0.000225
0.000159
-0.000038
0.000179
0.000139
-0.000005
0.000192
0.000119
-0.000012
0.000185
0.000113
-0.000005
0.000205
0.000133
-0.000025
0.000179
0.000067
0.000027
0.000133
0.000054
-0.000025
0.000159
0.000041
-0.000078
0.000133
0.000014
-0.000051
0.000185
0.000008
-0.000025
0.000277
0.000218
0.000251
0.00073
0.000658
0.000468
0.000605
0.000303
0.000336
0.000586
0.000362
0.000468
0.000277
0.000126
0.000369
0.000113
0.000054
0.000244
0.00008
0.000106
0.000336
-0.000019
0.000179
0.000422
0.000093
0.000376
0.00056
0.000159
0.000415
0.00052
0.000113
0.000369
0.000395
-0.000019
0.00033
0.000238
-0.000084
0.000277
0.000277
0.000087
0.000343
0.000185
0.000021
0.000251
0.000159
0.000067
0.000218
0.000185
0.000054
0.000231
0.000139
0.000126
0.000133
0.000172
0.000126
0.000225
0.000165
0.000067
0.000185
0.000119
0.00006
0.000152
0.000093
0.00006
0.000198
0.000067
0.000047
0.000152
0.000106
0.000014
0.000198
0.0001
0.0001
0.000527
0.000376
0.00056
0.000612
0.000592
0.000612
0.000514
0.000323
0.000573
0.000428
0.000257
0.000514
0.000211
0.000185
0.000323
0.000054
0.00008
0.000343
-0.000045
0.000093
0.000343
-0.000005
0.000218
0.000461
0.0001
0.000369
0.000474
0.000133
0.000422
0.000395
0.000041
0.000284
0.000264
-0.000025
0.000185
0.000119
-0.000019
0.000264
0.000133
0.000014
0.000198
0.000106
0.000021
0.000119
0.000113
-0.000025
0.000119
0.000054
0.000008
0.000093
0.0001
-0.000045
0.000106
0.000054
-0.000005
0.000093
0.000093
-0.000064
0.000133
0.000087
-0.000058
0.000126
0.000054
-0.000058
0.000185
0.000027
-0.000045
0.000165
-0.000032
-0.000012
0.000198
0.000073
0.000395
0.000592
0.000494
0.000474
0.000428
0.000468
0.000362
0.000566
0.00031
0.000441
0.000231
0.000205
0.000336
0.000054
0.000067
0.000257
-0.000137
-0.000051
0.000316
-0.00013
0.000159
0.000382
-0.000019
0.000323
0.000422
0.000093
0.000382
0.000441
0.0001
0.000362
0.000303
0.000027
0.000185
0.000192
-0.000064
0.000159
0.000192
0.000054
0.000244
0.000165
0.000093
0.000159
0.000067
0.000067
0.000106
0.000087
0.000106
0.00027
0.000113
0.00006
0.000133
0.0001
0.000041
0.000159
0.000126
0.000054
0.000231
0.000119
0.000001
0.000225
0.0001
0.000027
0.000297
0.000126
0.000146
0.000264
0.000073
0.0001
0.000225
0.000034
0.000165
0.000336
0.000297
0.000625
0.000743
0.000586
0.000619
0.000376
0.000527
0.000638
0.000441
0.000376
0.0005
0.000106
0.0001
0.00033
-0.000064
0.000014
0.000356
-0.00013
0.000179
0.000257
-0.000163
0.000231
0.000362
0.000021
0.000382
0.000402
0.000113
0.000461
0.000356
0.000133
0.000349
0.000179
0.000014
0.000225
0.000067
-0.000025
0.000251
0.000139
0.000087
0.000238
0.000119
0.000041
0.000159
0.00008
0.00006
0.000139
0.000093
0.000034
0.000218
0.000093
0.000008
0.000172
0.000172
0.000008
0.000238
0.000119
-0.000005
0.000172
0.000047
-0.000005
0.000172
-0.000012
-0.000032
0.000152
-0.000032
0.000001
0.000119
-0.000078
0.00006
0.000093
-0.000084
0.000152
0.000297
0.000461
0.000507
0.000605
0.000356
0.000454
0.000251
0.000297
0.000665
0.000277
0.000251
0.000474
0.000126
0.000133
0.000316
-0.00015
0.0001
0.000205
-0.000176
0.000087
0.000192
-0.000078
0.000225
0.000297
0.000087
0.000336
0.000395
0.000159
0.000428
0.000303
0.000073
0.000238
0.000152
-0.000071
0.000047
0.000073
-0.000025
0.000165
0.000126
0.000014
0.000139
0.000067
-0.000045
0.000113
0.000067
-0.000064
0.000133
0.000034
-0.000064
0.000139
0.000047
-0.000064
0.000172
0.000001
-0.000084
0.000192
0.000001
-0.000078
0.000152
-0.000045
-0.000064
0.000126
-0.000038
0.000014
0.000172
-0.000091
0.000041
0.000054
-0.000084
0.000126
0.000014
0.000021
0.000546
0.0005
0.000448
0.000697
0.000376
0.000461
0.000579
0.000297
0.0005
0.000619
0.000139
0.000257
0.000507
-0.000032
0.000218
0.000323
-0.000117
0.00027
0.00027
-0.000124
0.000284
0.00031
0.000047
0.000415
0.000402
0.000218
0.000468
0.000369
0.000251
0.000389
0.000257
0.000172
0.000231
0.000133
0.000041
0.000172
0.000146
0.0001
0.000251
0.000126
0.000073
0.000133
0.000119
0.000041
0.000119
0.000106
0.000034
0.000133
0.0001
0.000054
0.000146
0.000087
0.00006
0.000165
0.000054
0.000087
0.000185
-0.000038
0.000054
0.000139
-0.000025
0.000133
0.000146
-0.000038
0.000159
0.000113
-0.000091
0.000205
0.000067
0.000008
0.000257
0.000073
0.000356
0.000829
0.000448
0.000645
0.000665
0.00029
0.000468
0.000717
0.000284
0.000428
0.000494
0.000041
0.000238
0.00029
-0.000104
0.000172
0.000133
-0.000104
0.000198
0.000172
-0.000084
0.000264
0.000225
0.00008
0.000382
0.00029
0.000139
0.000323
0.00027
0.000126
0.000172
0.000133
-0.000019
0.000093
0.000034
-0.000084
0.000126
0.0001
0.000014
0.000139
0.00008
-0.000038
0.000126
0.00008
-0.000084
0.000172
0.000119
-0.000045
0.000179
0.000093
-0.000019
0.000218
0.00008
-0.000012
0.000192
-0.000012
0.000027
0.000179
-0.000045
0.00008
0.000146
-0.000071
0.000159
0.000093
-0.000045
0.000211
0.000041
-0.000084
0.000205
-0.000064
-0.000071
0.000316
0.000067
0.000264
0.000921
0.000481
0.000435
0.000619
0.000244
0.000435
0.000612
0.000198
0.000395
0.000356
-0.000104
0.000152
];
REQUIREMENTFORLOCALMAX = 0.0005;
USERESTIMATEFORMAXIMA = 21;

[peakVal, peakLoc] = findpeaks(data,"DoubleSided", "MinPeakDistance", 3);
LocalMaxInterval = [];
localmaxintervalcount = 1;
for i = 1:length(peakLoc)
  if(peakVal(i) > REQUIREMENTFORLOCALMAX)
    LocalMaxInterval(localmaxintervalcount) = peakLoc(i);
    localmaxintervalcount = localmaxintervalcount + 1;
  end
end
interval = [];
index = 1;
LocalMinima = [];
LocalMaxima = [];
LocalMaximaPeakLoc = [];
LocalMinimaPeakLoc = [];
localmaximacount = 1;
localminimacount =1;
iterator = 1;
lowerbound = 0;
upperbound = 0;
while(!(upperbound>length(data)) && !(iterator>length(LocalMaxInterval)))
  lowerbound = LocalMaxInterval(iterator)-0; # CHANGE to -10 IF LOCAL MINIMA OCCURS BEFORE LOCAL MAXIMA
  upperbound = LocalMaxInterval(iterator) +10;
  if(upperbound >length(data))
    upperbound = length(data);
  end
  fprintf("lowerbound: %d\t upperbound: %d\n", lowerbound, upperbound);
  for i = lowerbound:upperbound
      interval(index) = data(i);
      index = index +1;
  end
  LocalMinima(localminimacount) = min(interval);
  LocalMaxima(localmaximacount) = max(interval);
  for i = lowerbound: upperbound
    if(data(i) == LocalMinima(localminimacount))
      LocalMinimaPeakLoc(localminimacount) = i;
    elseif(data(i) == LocalMaxima(localmaximacount))
      LocalMaximaPeakLoc(localmaximacount) = i;
    end
  end
  localmaximacount = localmaximacount + 1;
  localminimacount = localminimacount + 1;

  index = 1;
  interval = [];
  iterator = iterator +1;
endwhile
disp("RESULTS\n\n");
for i = 1: length(LocalMaxima)
  fprintf("Local Maxima Number: %i\t\tLocal Maxima Value: %d\t\t Local Maxima Pos: %d\n", i, LocalMaxima(i), LocalMaximaPeakLoc(i));
end  
fprintf("Local Maxima Average: %d\n", mean(LocalMaxima));
fprintf("Local Maxima Standard Deviation: %d\n\n", std(LocalMaxima));

for i = 1: length(LocalMinima)
  fprintf("Local Minima Number: %i\t\tLocal Minima Value: %d\t\t Local Minima Pos: %d\n", i, LocalMinima(i), LocalMinimaPeakLoc(i));
end  
fprintf("Local Minima Average: %d\n", mean(LocalMinima));
fprintf("Local Minima Standard Deviation: %d\n\n", std(LocalMinima));
if(USERESTIMATEFORMAXIMA == length(LocalMaxima))
  fprintf("Software estimate was CORRECT according to the user estimate\n")
else
  fprintf("Software estimate was INCORRECT according to the user estimate, please manually check the data.\n")
end
plot(data);
hold on
for i = 1:length(LocalMinima)
  scatter(LocalMinimaPeakLoc(i), LocalMinima(i), 280);
end
for i =1:length(LocalMaxima)
  scatter(LocalMaximaPeakLoc(i), LocalMaxima(i), 280);
end
hold off
%}